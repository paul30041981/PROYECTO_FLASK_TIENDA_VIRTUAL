window.onload= function(){

  $('#deleteModal').on('show.bs.modal', function (event) {
      var button = $(event.relatedTarget) // Button that triggered the modal
      var name = button.data('name') // Extract info from data-* attributes
      var id = button.data('id') // Extract info from data-* attributes
      // If necessary, you could initiate an AJAX request here (and then do the updating in a callback).
      // Update the modal's content. We'll use jQuery here, but you could use a data binding library or other methods instead.
      var modal = $(this)
      modal.find('.modal-title span').text(name)

      $("#deleteProducto").attr("href","/producto_delete/"+id)

      
  })

   var productoModal = document.getElementById('productoModal')
   productoModal.addEventListener('show.bs.modal', function (event) {
        // Button that triggered the modal
        var button = event.relatedTarget

        // Extract info from data-bs-* attributes
        var proceso = button.getAttribute('data-proceso')
        var id = button.getAttribute('data-id')
        var name = button.getAttribute('data-name')
        var precio = button.getAttribute('data-price')
        var categoria = button.getAttribute('data-categoria')
        var stock = button.getAttribute('data-stock')
        var perecerero = button.getAttribute('data-perecerero')
        var medida = button.getAttribute('data-medida')
        var estado = button.getAttribute('data-estado')

        

        var fecha_ven = button.getAttribute('data-fecha_ven')
        var descripcion = button.getAttribute('data-descripcion')

        // Update the modal's content.
        var modalTitle = productoModal.querySelector('.modal-title')
        var modalBodyInput = productoModal.querySelectorAll('.modal-body input')
        var modalBodySelect = productoModal.querySelectorAll('.modal-body select')
        var modalBodyTexarea = productoModal.querySelectorAll('.modal-body textarea')

        console.log('modalBodySelect:' + modalBodyInput)
        console.log('modalBodySelect:' + modalBodySelect)

        var modalBodyInputName = modalBodyInput[0]
        var modalBodyInputPrecio = modalBodyInput[1]
        var modalBodyInputStock = modalBodyInput[2]
        var modalBodyInputPerecerero = modalBodyInput[3]
        var modalBodyInputFechaVencimiento = modalBodyInput[4]
        var modalBodySelectCategoria = modalBodySelect[0]
        var modalBodySelectMedida = modalBodySelect[1]
        var modalBodySelectEstado = modalBodySelect[2]
        var modalBodyTexareaDesc = modalBodyTexarea[0]

        //Update texto y opciones de controles input y select
        if(proceso === 'V'){
            modalTitle.textContent = 'Detalle del Producto:   '+'"' + name +'"'
            modalBodyInputName.disabled = true
            modalBodyInputPrecio.disabled = true
            modalBodyInputStock.disabled = true
            modalBodyInputPerecerero.disabled = true
            modalBodyInputFechaVencimiento.disabled = true
            modalBodySelectCategoria.disabled = true
            modalBodySelectMedida.disabled = true
            modalBodySelectEstado.disabled = true
            modalBodyTexareaDesc.disabled = true
            $("#saveSubmitModal").attr("hidden","true")
            $("#editForm").attr("action","#")
        } else if (proceso === 'E') {
            modalTitle.textContent = 'Editar Producto:   '+'"' + name +'"'
            modalBodyInputName.disabled = null
            modalBodyInputPrecio.disabled = null
            modalBodyInputStock.disabled = null
            modalBodyInputPerecerero.disabled = null
            modalBodyInputFechaVencimiento.disabled = null
            modalBodySelectCategoria.disabled = null
            modalBodySelectMedida.disabled = null
            modalBodySelectEstado.disabled = null
            modalBodyTexareaDesc.disabled = null
            $("#saveSubmitModal").attr("hidden",null)
            $("#editForm").attr("action","/producto_update/"+id)
        } else if (proceso === 'A') {
            modalTitle.textContent = 'Nuevo Producto:  '
            modalBodyInputName.disabled = null
            modalBodyInputPrecio.disabled = null
            modalBodyInputStock.disabled = null
            modalBodyInputPerecerero.disabled = null
            modalBodyInputFechaVencimiento.disabled = null
            modalBodySelectCategoria.disabled = null
            modalBodySelectMedida.disabled = null
            modalBodySelectEstado.disabled = true
            modalBodyTexareaDesc.disabled = null
            $("#saveSubmitModal").attr("hidden",null)
            $("#editForm").attr("action","/producto_create")
        } else {
        //  block of code to be executed if the condition1 is false and condition2 is false
        }

        //Update texto

        modalBodyInputName.value = name
        modalBodyInputPrecio.value = precio
        modalBodyInputStock.value = stock
        modalBodyInputPerecerero.value = perecerero.value
        modalBodyInputFechaVencimiento.value = fecha_ven
        modalBodySelectCategoria.value = categoria
        modalBodySelectMedida.value = medida
        modalBodySelectEstado.value = estado
        modalBodyTexareaDesc.value = descripcion


        if(perecerero!=null && perecerero === "True"){
            modalBodyInputPerecerero.value = "y"
            modalBodyInputPerecerero.checked = "checked"
        }else{
            modalBodyInputPerecerero.checked = null
            modalBodyInputPerecerero.value = ""
        }
 
    })


    var carritoModal = document.getElementById('carritoModal')
    carritoModal.addEventListener('show.bs.modal', function (event) {
        // Button that triggered the modal
        var button = event.relatedTarget
        // Extract info from data-bs-* attributes
        var proceso = button.getAttribute('data-proceso')
        var id = button.getAttribute('data-id')
        var name = button.getAttribute('data-name')
        var precio = button.getAttribute('data-price')
        var categoria = button.getAttribute('data-categoria')
        var stock = button.getAttribute('data-stock')
        var perecerero = button.getAttribute('data-perecerero')
        var medida = button.getAttribute('data-medida')
        var estado = button.getAttribute('data-estado')
        var fecha_ven = button.getAttribute('data-fecha_ven')
        var descripcion = button.getAttribute('data-descripcion')
        //Seteo de valores
        $("#name_carrito").attr("value",name)
        $("#category_carrito").attr("value",categoria)
        $("#price_carrito").attr("value",precio)
        $("#medida_carrito").attr("value",medida)
        $("#stock_carrito").attr("value",stock)
        $("#perecerero_carrito").attr("value",(perecerero ? "Si" : "No"))
        $("#fecha_vencimiento_carrito").attr("value",fecha_ven)
        $("#estado_carrito").attr("value",estado)
        $("#descripcio_carrito").attr("value",descripcion)
        $("#carritoForm").attr("action","/producto_seleccionado/"+id)
    
    })

    $("[type='number']").keypress(function (evt) {
        evt.preventDefault();
    });
}